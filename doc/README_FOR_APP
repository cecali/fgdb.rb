= _F_ree_G_eek _D_ata_B_ase in _R_u_B_y

== How stuff works

this webapp is meant to keep track of two main areas:
* volunteers and the time they work
* gizmos and their flow through our organization

the /volunteer_tasks controller tracks volunteers and their hours.
the /transaction controller takes care of gizmo flow.
the /reports controller has some useful numbers.

in the near future i hope to add:
* classes and who has completed them
* projects (such as building and testing a computer) and who has worked on them

a bunch of other controllers are scattered around to support these,
but should not be used by typical users.

== Install

we made this on debian lenny systems. alteration may be needed on other distros.

To get the mr setup:

 $> apt-get install subversion mr
 $> svn co http://dev.freegeek.org/svn/fgdb.rb/mr/ fgdb.rb
 $> cd fgdb.rb

If you are going to be doing development, you should use the latest (untested, unreleased, and possibly unusable) trunk:
 $> touch devel

Checkout the sources (you first need to setup mr, see above):
 $> mr -c config update

To upgrade to the newest sprint release:
 $> svn up && mr -c config update
 $> cd current
 $> RAILS_ENV=production rake db:migrate

to setup a working environment:

 $> apt-get install ruby postgresql-8.1 libpgsql-ruby irb libxml-ruby
 $> apt-get install rails #version 2.1
 $> aptitude hold rails # so we don't upgrade to a bad version
 $> ln -s /usr/share/rails vendor/rails

you need to create and configure the databases:

 $> su - postgres -c 'createuser -P SOMEDBUSER'
      # capable of creating databases, but nothing else
 $> createdb -h localhost -U SOMEDBUSER fgdb_production
 $> createdb -h localhost -U SOMEDBUSER fgdb_test
 $> createdb -h localhost -U SOMEDBUSER fgdb_development
 $> cd fgdb.rb/trunk
   ::: edit config/database.yml-example to match and rename
   ::: it (drop '-example')
 $> export RAILS_ENV=production
 $> rake db:schema:load

choose one of the following: skeletal metadata, or full test data:

 $> rake db:metadata:load
   :OR:
 $> zcat db/devel_data.sql.gz | psql -h localhost -U SOMEUSER fgdb_production
 $> rake db:migrate

run some tests to see if things look okay:

 $> rake db:test:purge
 $> rake

if you see any failures or errors,
something is wrong that you should fix or tell us about.
then start the server and browse in to see things working:

 $> ./script/server &
 $> iceweasel http://localhost:3000

feel free to read the notes and listen to an audio log from our
install at the vancouver freegeek site:
http://puddle.ca/~joe/freegeek/martin_install.ogg
http://puddle.ca/~joe/freegeek/fg_database_install-HOWTO

for a production server running apache and fcgid,
continue with the following:

 $> apt-get install apache2 libapache2-mod-fcgid libfcgi-ruby1.8
 $> a2enmod rewrite
 $> chown -R www-data:www-data tmp log public
 $> cp doc/examples/apache2_sites-available_default /etc/apache2/sites-available/default
   ::: modify apache config to taste :::
   ::: edit config/environment.rb to say "ENV['RAILS_ENV'] ||= 'production'" :::
 $> a2ensite default

== TODO

see our trac (http://dev.freegeek.org/projects/fgdb.rb/) for details,
but some important tasks left unfinished:

* non-ajax interface
* deb package

== THANKS

in chronological order of svn commits:

* Martin Chase <mchase@freegeek.org>
* Jeff Schwaber
* Gordon Pederson
* Richard Seymour <rfs@freegeek.org>
* Tim Bauman
* Eric Davis
* Lantz Moore
* Ryan Niebur <RyanRyan52@gmail.com>
