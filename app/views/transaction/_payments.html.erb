<table id="payment_lines">
  <tr>
    <th>Payment Method</th>
    <th>Amount</th>
    <th></th>
  <tr>
    <% if @transaction.payments %>
      <% @gizmos_and_payments_js ||= "" %>
      <% for line in @transaction.payments %>
        <% hash = {} %>
        <% hash[:payment_method_id] = line.payment_method_id %>
        <% hash[:payment_amount] = line.amount %>
        <% @gizmos_and_payments_js += "add_payment(#{hash.to_json});" %>
      <% end %>
    <% end %>

  <tr>
    <td><select id="payment_method_id">
        <%= options_from_collection_for_select([GizmoType.new(:id=>1, :description=>"pick a payment type")] + (PaymentMethod.find(:all) - (@gizmo_context.name == "donation" ? [PaymentMethod.find_by_name("store_credit")] : [])).sort_by(&:description), "id", "description") %>
      </select></td>
    <td><input id="payment_amount" name="payment_amount" onkeydown="if(is_tab(event)) {return handle_payments();}"/></td>
  </tr>
</table>
