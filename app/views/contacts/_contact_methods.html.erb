<table id="contact_methods_lines">
  <tr>
    <th>type</th>
    <th>is usable</th>
    <th>value</th>
    <th></th>
  </tr>
  <%
    js = "my_instance = new ContactMethodFrontend;"
    if @contact.contact_methods %>
  <%
    l = @contact.contact_methods.map{|x|
      x = x.to_hash(:id, :contact_method_type_id, :ok, :value)
      x[:contact_method_usable] = x[:ok]
      x[:contact_method_value] = x[:value]
      x.delete(:value)
      x.delete(:ok)
      x
    }
    puts l.to_json
    js += "my_instance.add_many(#{l.to_json});"
    %>
  <% end %>
  <%= javascript_tag js %>

  <tr id="contact_methods_form">
    <td><select id="contact_method_type_id" onchange="contact_contact_method_selected()">
        <%= options_from_collection_for_select([ContactMethodType.new(:id=>1, :description=>"pick a type")] + ContactMethodType.find(:all).sort_by(&:description), "id", "description") %>
      </select></td>
    <td><input name="is_usable" id="is_usable" type="checkbox"></td>
    <td><input name="contact_method_value" id="contact_method_value" onkeydown="if(is_tab(event)) {return my_instance.add_from_form();}"></td>
    <td></td>
  </tr>
</table>
